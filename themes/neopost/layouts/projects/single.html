{{ define "main" }}
<div id="content">
    <aside id="sidebar">
        <div id="avatar">
            {{ with .Site.GetPage "section" "/sidebar/_index.md" }}
            <img class="flower" src="{{ index .Params "icon-path" }}">
            {{ end }}
        </div>
        
        <div id="bio">
        {{ with .Site.GetPage "section" "/sidebar/bio.md" }}
            {{ .Content | safeHTML }}
        {{ end }}
        </div>
        
        <div class="small-box">
            {{ with .Site.GetPage "section" "/sidebar/basic-info.md" }}
                {{ .Content | safeHTML }}
            {{ end }}
        </div>

        <nav class="links">
            <ul>
            {{ with .Site.GetPage "section" "/sidebar/_index.md" }}
            {{ range .Params.links }}
                <li><a href="{{ .link }}">{{ .name }}</a></li>
            {{ end }}
            {{ end }}
            </ul>
        </nav>
    </aside>
    
    <main>
        <article>
            <h1>{{ .Title }}</h1>
            
            <!-- Tags -->
            {{ with .Params.tags }}
            <div style="margin: 0.5em 0;">
                tags:
                {{ range $index, $tag := . }}
                <a href="{{ relLangURL (printf "/tags/%s" $tag) }}">{{ $tag }}</a>{{ if ne $index (sub (len $) 1) }},{{ end }}
                {{ end }}
            </div>
            {{ end }}
            
            <!-- Tech stack -->
            {{ with .Params.tech }}
            <div style="margin: 0.5em 0;">
                {{ range . }}
                <span style="background: var(--accent-color); color: white; padding: 0.3em 0.8em; border-radius: 15px; font-size: 0.85em; font-weight: bold; margin-right: 0.3em; display: inline-block;">{{ . }}</span>
                {{ end }}
            </div>
            {{ end }}
            
            <div class="post-header">
                <span class="timestamp">{{ .Date.Format "02/01/2006" }}</span>
            </div>
            
            {{ with .Params.image }}
            <div style="margin: 1em 0;">
                <img src="{{ . }}" alt="{{ $.Title }}" style="max-width: 100%; border-radius: 10px;">
            </div>
            {{ end }}
            
            <div class="project-content">
                {{ .Content }}
            </div>
            
            <!-- Back to projects link -->
            <div style="margin-top: 2em; padding-top: 1em; border-top: 2px dashed var(--border-color);">
                <a href="/projects/" style="display: inline-block; padding: 0.5em 1.5em; background: var(--bg-color); border: 2px solid var(--accent-color); color: var(--text-color); text-decoration: none; border-radius: 20px; font-weight: bold;">‚Üê Back to Projects</a>
            </div>
        </article>
    </main>
    
    <aside id="right-sidebar">
        <div class="status-box">
            {{ with .Site.GetPage "section" "/sidebar/currently.md" }}
            <h3>Currently</h3>
            <ul class="status-list">
                <li>üìñ reading: <span>{{ .Params.reading }}</span></li>
                <li>üéµ listening: <span>{{ .Params.listening }}</span></li>
                <li>üéÆ playing: <span>{{ .Params.playing }}</span></li>
                <li>üí≠ mood: <span>{{ .Params.mood }}</span></li>
            </ul>
            {{ end }}
        </div>

        <div class="pixel-pet">
            <img src="/mew.gif" alt="pixel pet" id="pet">
            <p class="pet-status">Mew is vibing!</p>
        </div>

        <div class="quote-box">
            <h3>üí≠ Random Thought</h3>
            <p id="random-quote"></p>
            <button onclick="newQuote()">‚ú® New Quote</button>
        </div>
    </aside>
</div>

<script>
(function() {
    const quotesJSON = '{{ with .Site.GetPage "section" "/sidebar/quotes.md" }}{{ .Params.quotes | jsonify }}{{ end }}';
    const quotes = JSON.parse(quotesJSON);
    
    window.newQuote = function() {
        const randomIndex = Math.floor(Math.random() * quotes.length);
        const quote = quotes[randomIndex];
        document.getElementById('random-quote').textContent = quote;
    }
    
    window.addEventListener('DOMContentLoaded', newQuote);
})();
</script>
{{ end }}
